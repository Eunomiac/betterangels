@mixin radial-menu($radius, $num-buttons, $height, $depth: 1) {
	$horiz-shift: 0; // 10;
	$vert-shift: 0; // 3;
	$menu-size: $radius * 2;

	&.size#{$radius}-#{$num-buttons}items {
		top: calc(50% - #{$radius});
		left: calc(50% - #{$radius});
		z-index: $depth + 5;
		width: $menu-size;
		height: $menu-size;

		.menu-container {
			@for $i from 1 through $num-buttons {
				.menu-button:nth-child(#{$i}) button,
				.menu-button:nth-child(#{$i}) label {
					animation-delay: $i * 1s / $num-buttons;
				}
			}

			.menu-button {
				// width: $radius / 2;
				// height: auto;
				margin-top: -($height / 2);
				margin-left: -($radius / 4);

				$angle: (360 / $num-buttons);
				$rot: 0;
				$transform-translate: "";
				$transform-rotate: "";
				$transform-children: "";

				@for $i from 1 through $num-buttons {
					@if $num-buttons == 8 {
						@if $i == 1 { // Cyan
							$transform-translate: "translateX(#{$horiz-shift}px)";
						} @else if $i == 2 { // Red  rotate(170deg)
							$transform-translate: "translateX(#{$horiz-shift}px) translateY(#{$vert-shift}px)";
							$transform-rotate: "rotate(75deg)";
							$transform-children: "rotate(-75deg)";
						} @else if $i == 4 { // Green  rotate(170deg)
							$transform-translate: "translateX(#{$horiz-shift}px) translateY(-#{$vert-shift}px)";
							$transform-rotate: "rotate(170deg)";
							$transform-children: "rotate(-170deg)";
						} @else if $i == 5 {
							$transform-translate: "translateX(-#{$horiz-shift}px)";
						} @else if $i == 6 {
							$transform-translate: "translateX(-#{$horiz-shift}px) translateY(-#{$vert-shift}px)";
							$transform-rotate: "rotate(75deg)";
							$transform-children: "rotate(-75deg)";
						} @else if $i == 8 {
							$transform-translate: "translateX(-#{$horiz-shift}px) translateY(#{$vert-shift}px)";
							$transform-rotate: "rotate(170deg)";
							$transform-children: "rotate(-170deg)";
						}
					}
					&:nth-of-type(#{$i}) {
						transform:
							rotate($rot * 1deg)
							translate(0.5 * $menu-size / 2)
							rotate($rot * -1deg)
							#{$transform-translate};
					}

					$rot: $rot + $angle;
				}
			}
		}
	}
}

& {
	
$tactic-dot-size: 15px;
$strategy-dot-size: 19px;
$tactic-spacing: $tactic-dot-size + 1px;
$strategy-spacing: $strategy-dot-size + 1px;

text-shadow: 0 0 5px $c-bg-dark, 0 0 2px $c-bg-dark, 0 0 5px $c-bg;

&.hellbound {
	width: 476px !important;
	height: 786px !important;
	overflow: visible !important;
	border-radius: 25px;

	.window-content { 
		max-height: calc(100% - (2 * 25px));
		overflow: visible !important;
	}
	.window-resizable-handle { display: none }
}

.trait-line {
	display: grid;
	grid-template-columns: #{9 * $tactic-spacing} #{7 * $strategy-spacing} #{9 * $tactic-spacing};
	grid-gap: $tactic-spacing;

	* {
		pointer-events: none;
		transform-origin: 50% 50%;
	}

	.trait-pair {
		display: grid;
		position: relative;
		grid-template-rows: repeat(4, var(--dot-size));
		grid-gap: 1px;
		margin-top: auto;
		margin-bottom: auto;
		z-index: 5;

		> label {
			position: relative;
			transition: 3;
			--video-horiz-shift: 0px;

			> video {
				position: absolute;
				width: 160px;
				height: 100%;
				transform: scale(6) scaleY(2);
				display: none;
				z-index: 1;
			}

			> span { position: absolute }

			&.sinister {
				grid-row: 1;
				margin-left: -20px;
				> video { left: calc(-40px + var(--video-horiz-shift)) }
				> span {
					left: 0;
				}
			}

			&.virtuous {
				grid-row: 4;
				margin-right: -20px;

				> video { right: calc(-40px + var(--video-horiz-shift)) }
			}

			&:hover {
				> video {
					display: initial;
				}

				> span.display {
					color: $c-bg-dark;
					text-shadow: none;
					transition: 0.5s;
					transform: scale(1.2);
				}
			}
		}

		.trait-grid {
			display: grid;
			position: relative;
			grid-template-rows: repeat(2, var(--dot-size));
			grid-template-columns: repeat(7, var(--dot-size));
			grid-row: 2 / span 2;
			grid-gap: 1px;
			margin-top: auto;
			margin-bottom: auto;
			pointer-events: all;
			z-index: 5;

			.dot {
				position: relative;
				border: 1px solid $c-fg;
				border-radius: 50%;

				> .dot-slot {
					position: absolute;
					// display: block;
					// left: 0;
					// top: 0;
					height: 100%;
					width: 100%;
					border-radius: 50%;
					background: transparent;

					&.full {
						background: radial-gradient(ellipse, $c-fg-bright, $c-fg 70%);
					}

					&.top-layer {
						z-index: 10000;
						pointer-events: none !important;
					}
				}

				&.top-1 {
					grid-row: 1;
					grid-column: 1;
				}

				&.top-2 {
					grid-row: 1;
					grid-column: 2;
				}

				&.top-3 {
					grid-row: 1;
					grid-column: 3;
				}

				&.top-4 {
					grid-row: 1;
					grid-column: 4;
				}

				&.top-5 {
					grid-row: 1;
					grid-column: 5;
				}

				&.bottom-5 {
					grid-row: 2;
					grid-column: 3;
				}

				&.bottom-4 {
					grid-row: 2;
					grid-column: 4;
				}

				&.bottom-3 {
					grid-row: 2;
					grid-column: 5;
				}

				&.bottom-2 {
					grid-row: 2;
					grid-column: 6;
				}

				&.bottom-1 {
					grid-row: 2;
					grid-column: 7;
				}
			}
		}

		&.tactic {
			--dot-size: #{$tactic-dot-size};

			width: 7 * $tactic-spacing + 2 * $tactic-spacing;
			padding: $tactic-spacing;

			> label {
				font-family: $font-primary;
				line-height: $tactic-dot-size - 1px;

				> video { top: 3px }

				&#trait-label-contempt { --video-horiz-shift: -7px }
				&#trait-label-corruption { --video-horiz-shift: 0px }
				&#trait-label-courage { --video-horiz-shift: -10px }
				&#trait-label-cruelty { --video-horiz-shift: -15px }
				&#trait-label-deceit { --video-horiz-shift: -20px }
				&#trait-label-endurance { --video-horiz-shift: 0px }
				&#trait-label-espionage { --video-horiz-shift: -7px }
				&#trait-label-generosity { --video-horiz-shift: 0px }
				&#trait-label-greed { --video-horiz-shift: -25px }
				&#trait-label-honesty { --video-horiz-shift: -5px }
				&#trait-label-knowledge { --video-horiz-shift: 0px }
				&#trait-label-nurture { --video-horiz-shift: -10px }
			}
		}

		&.strategy {
			--dot-size: #{$strategy-dot-size};

			width: 7 * $strategy-spacing;

			> label {
				font-family: $font-secondary;
				line-height: $strategy-dot-size - 1px;

				> video { top: 5px }
				
				&#trait-label-cunning { --video-horiz-shift: -10px }
				&#trait-label-devious { --video-horiz-shift: -10px }
				&#trait-label-insightful { --video-horiz-shift: 5px }
				&#trait-label-open { --video-horiz-shift: -15px }
				&#trait-label-patient { --video-horiz-shift: 0px }
				&#trait-label-sly { --video-horiz-shift: -30px }
			}
		}
	}
}

.menu-positioner {
	position: absolute;

	.radial-menu {
		position: absolute;
		display: block;
		padding: 0;
		background: transparent;
		border-radius: 50%;
		opacity: 0%;
		transition: 0.5s;
		transform: scale(0.3) rotate(-125deg);
		pointer-events: all;

		@include radial-menu(60px, 8, 14px);
		@include radial-menu(50px, 8, 14px);
		@include radial-menu(100px, 8, 14px);
		@include radial-menu(150px, 8, 14px);

		&.depth-1 { z-index: 2 }
		&.depth-2 { z-index: 4 }
		&.depth-3 { z-index: 6 }
		&.depth-4 { z-index: 8 }

		&:not(.active) {
			pointer-events: none !important;

			* {
				pointer-events: none !important;
			}
		}

		video {
			position: absolute;
			top: -50%;
			left: -50%;
			width: 200%;
			height: 200%;
			opacity: 100%;
			transform: scale(1.75);
			opacity: 0.75;
		}

		.menu-container {
			position: absolute;
			top: -20%;
			left: -20%;
			width: 140%;
			height: 140%;
			list-style: none;

			.menu-button {
				position: absolute;
				display: block;
				top: 50%;
				left: 50%;
				height: 20px;
				width: 30px;
				// transition: 0.5s;

				@keyframes slow-bob {
					from { top: -3px; }
					to { top: 3px; }
				}

				button {
					position: absolute;
					padding: 0;
					margin: 0;
					height: 100%;
					width: 100%;

					// background-color: rgba(255, 0, 255, 0.5);
					// outline: 2px solid rgba(255, 0, 255, 1);
					// font-weight: bold;
					// color: var(--button-color);
					// text-shadow: -1px -1px 2px #000000, 1px -1px 2px #000000, -1px 1px 2px #000000, 1px 1px 2px #000000;
					background: transparent;
					background-size: 30px 20px;
					border: none;
					outline: none;
					box-shadow: none;
					transition: 0.5s;
					animation: slow-bob 2s cubic-bezier(0.36, 0, 0.63, 1) infinite alternate;
					
					&.button-add-drop {
						background-image: url("/systems/betterangels/assets/icons/add-drop-bg.webp");

						&.active-add {
							background-image: url("/systems/betterangels/assets/icons/add-active.webp");
							pointer-events: all;
						}										
						&.active-drop {
							background-image: url("/systems/betterangels/assets/icons/drop-active.webp");
							pointer-events: all;
						}
						&.active-add.active-drop {
							background-image: url("/systems/betterangels/assets/icons/add-drop-active.webp");
							pointer-events: all;
						}
					}
					&.button-slide-left {
						background-image: url("/systems/betterangels/assets/icons/slide-left-bg.webp");		

						&.active-slide-left {
							background-image: url("/systems/betterangels/assets/icons/slide-left.webp");
							pointer-events: all;
						}
					}
					&.button-slide-right {
						background-image: url("/systems/betterangels/assets/icons/slide-right-bg.webp");

						&.active-slide-right {
							background-image: url("/systems/betterangels/assets/icons/slide-right.webp");
							pointer-events: all;
						}
					}		
				}
			}
		}

		&.active {
			z-index: 20;
			opacity: 100%;
			transform: scale(1) rotate(0deg);

			.menu-container {
				padding: 0;
				margin: 0;
				list-style: none;
				// pointer-events: all;

				// .menu-button:not(.empty) { pointer-events: all }

				.menu-button:hover {
					z-index: 10;

					button {
						// pointer-events: all;
						// background: var(--button-bg);
						// box-shadow: 0 0 2px var(--button-bright), 0 0 2px var(--button-bright), 0 0 2px var(--button-bright);
						transform: scale(2);
					}
				}
			}
		}
	}
}

.features-list {
	width: 100%;

	.feature-row {
		display: flex;
		justify-content: space-evenly;
		align-content: space-around;
		padding: 10px 0;

		.feature {
			height: 125px;
			width: 125px;

			img {
				position: relative;
				display: block;
				border: 0;
				margin-bottom: -125px;

				&.aspect-coin {
					filter: drop-shadow(16px 16px 16px #{$c-bg-dark});

					&:nth-of-type(3) {
						display: none;
					}
				}

				&.active {
					display: none;
				}
			}

			video {
				height: 125px;
				width: 125px;
				transform: translateY(5px) scale(2.6);
				position: relative;
				z-index: 5;
				pointer-events: none;
				display: none;
			}

			&:hover {
				.active { display: block }
				.base { display: none }
				video { display: block }

			}
		}
	}
}
}


#sheet-message {
	display: block;
	width: 100%;
	line-height: 20px;
	font-size: 20px;
	font-family: $font-primary;
	font-weight: bold;
	color: $c-fg;
	text-align: center;
	margin-top: 50px;

	h1, h2, h3 {
		display: block;
		border: none;
		margin: 20px 0;
		opacity: 0;
		width: 130%;
		margin-left: -15%;
	}
}
