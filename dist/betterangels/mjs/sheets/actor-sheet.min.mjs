import{C as t,gsap as e,Dragger as s,MotionPathPlugin as a,SplitText as i,U as r,MIX as o,UpdateQueue as n}from"../helpers/bundler.mjs";class h{constructor(t,{t:e,i:s,o:a,h:i,l:r,u:o,p:n,g:h,m:l}={}){this.$=t,this.v=l??this.$.sheet.m,this.T=e??[t.D],this.A=s??{C:{k:0,P:0,S:0,M:0},width:{k:0,P:0,S:0,M:0}},this.O=a??[],this._=i??0,this.R=r??1,this.I=o??0,this.j=n??0,this.F=h??10,[this.H]=$(t.target).find(".icons-top"),[this.N]=$(t.target).find(".icons-bottom"),this.B()}get m(){return this.v}get L(){return this.m.sheet}get X(){return this.m.data.data}get G(){return $(this.$.target)}get W(){return this.G.find(".icons-top")}get K(){return this.W.find(".roll-icon")}get V(){return this.G.find(".roll-desc")}get q(){return this.G.find(".icons-bottom")}get J(){return this.q.find(".roll-icon")}get U(){return Array.from(this.K).filter((t=>"advantage"===$(t).data("type"))).pop()}get t(){return this.T}set t(t){this.T=t}get l(){return this.R}set l(t){this.R=t}get i(){return this.A}set i(t){this.A=t}get h(){return this._}set h(t){this._=t}get o(){return this.O}set o(t){this.O=t}get u(){return this.I}set u(t){this.I=t}get p(){return this.j}set p(t){this.j=t}get g(){return this.F}set g(t){switch(t){case"heightMod":this.F=10+this.p;break;case"+heightMod":this.F+=this.p;break;default:this.F=t??10}}get Y(){return this.t.filter((e=>t.Y.includes(e)))}get Z(){return this.t.filter((e=>t.Z.includes(e)))}get tt(){return Object.fromEntries(this.t.map((t=>[t,this.X[t].value])))}get et(){return Object.values(this.tt).reduce(((t,e)=>t+e),0)}get st(){return{C:Object.values(this.i.C).reduce(((t,e)=>t+e),0),width:Object.values(this.i.width).reduce(((t,e)=>t+e),0)}}get it(){return this.st.C+this.o.length+this.h}get rt(){return this.et+this.u+this.it}get ot(){return{left:t.nt.size*this.W.children().length+t.nt.size/2,top:t.nt.size/2}}get ht(){return{left:t.nt.size*this.q.children().length+t.nt.size/2,top:t.nt.size/2}}lt(t,s){s=$(r.ct(s));const[a]=$(t).ut(s);return e.set(a,{dt:-50,gt:-50,...this[s.$t("icons-top")?"ot":"ht"],scale:3,yt:0,x:30,y:-30}),a}bt(e){const s=2/3*t.nt.size,a=1/3*t.nt.size,i=[{group:"general",ft:Array.from(e.find('*[data-sub-type="general"]'))},{group:"weapon",ft:Array.from(e.find('*[data-sub-type="weapon"]'))},{group:"surprise",ft:Array.from(e.find('*[data-sub-type="surprise"]'))},{group:"secret",ft:Array.from(e.find('*[data-sub-type="secret"]'))},{group:"mastery",ft:Array.from(e.find('*[data-type="mastery"]'))},...[1,2,3,4,5,6,7,8,9,10].map((t=>({group:`expert-${t}`,ft:Array.from(e.find(`*[data-type="expert"][data-value=${t}]`))})))].filter((({ft:t})=>t.length>0)),r=[],o=()=>r.reduce(((t,e)=>t+e),0);for(const e of i){o()>0&&r.push(a),e.vt=[];for(const a of e.ft)e.vt.push(o()+.5*t.nt.size),r.push(t.nt.size-s);r.push(s)}return[i,o()]}xt(){const[t,s]=this.bt(this.K),[a,i]=this.bt(this.J);e.to(this.W,{left:-.5*s,duration:.5,Tt:"sine.inOut"}),e.to(this.q,{left:-.5*i,duration:.5,Tt:"sine.inOut"});const[r,o]=[[],[]];for(const e of[...t,...a])r.push(...e.ft),o.push(...e.vt);e.to(r,{left:t=>o[t],scale:1,yt:1,duration:.5,Tt:"back",Dt:.2})}wt(){const e=[];for(const s of this.Y)e.push(t.nt.t.At(s,this.tt[s]));for(const s of this.Z)e.push(t.nt.t.Ct(s,this.tt[s]));this.it>0&&e.push(`${this.it}${t.nt.kt}`),this.u>0&&e.push(this.u),e[0]=e.join(" + "),e.length=1,this.u<0&&(e[0]=`${e[0]}<span class="red-text"> - ${Math.abs(this.u)}</span>`),this.rt>this.g?e.push(`<span class="red-text">${this.rt}</span>`):e.push(this.rt),this.V[0].innerHTML=e.join(" = ")}async B(){for(const[e,s]of Object.entries(this.i))for(const[a,i]of Object.entries(s))for(let s=1;s<=i;s++)this.lt(t.nt.i[a],"width"===e?this.q:this.W);for(const e of this.o)this.lt(t.nt.o[e],this.W);for(let e=1;e<=this.h;e++)this.lt(t.nt.Pt,this.W);this.xt(),this.wt()}async St(t){this.t.includes(t)||this.t.push(t),this.wt()}async Mt(t){this.t=this.t.filter((e=>t!==e)),this.wt()}async add(e){const s=$(e).data("type");switch(s){case"general":case"weapon":case"surprise":case"secret":this.lt(t.nt.i[s],this.W),this.i.C[s]++;break;case"mastery":this.lt(t.nt.Pt,this.W),this.h++;break;case"expert":{const s=$(e).data("value");this.lt(t.nt.o[s],this.W),this.o.push(s);break}}this.xt(),this.wt()}async Ot(){const t=this.U,s=e._t(t,"top"),a=this.ht.left,i=$(t).data("subType");this.i.C[i]--,this.i.width[i]++,r.Rt(t,this.q,!0);const o=e._t(t,"top"),n=(e._t(t,"left"),(s-o)/2+o);e.timeline({It:[this],Et(t){t.wt()}}).to(t,{left:-20,Tt:"sine.out",duration:.25},0).to(t,{top:n,Tt:"sine.in",duration:.25},0).to(t,{left:a,Tt:"sine.in",duration:.25},">").to(t,{top:s,Tt:"sine.out",duration:.25},"<")}async jt(){}async reset(){const t=[...Array.from(this.W.children()),...Array.from(this.q.children())];this.h=0,this.o=[],this.A={C:{k:0,P:0,S:0,M:0},width:{k:0,P:0,S:0,M:0}};const s=t.map((()=>{const t={x:e.Ft.random(-75,75)};return t.y=Math.sqrt(1e4-t.x**2)*(r.Ht()?1:-1),t}));e.to(t,{x:t=>s[t].x,y:t=>s[t].y,rotation:"+=720",scale:3,yt:0,duration:.5,Dt:.25,Tt:"power2.out",Et(){$(t).remove()}}),this.wt()}async Nt(){}}class l extends(o(ActorSheet).Bt(n)){static get Lt(){return mergeObject(super.Lt,{zt:["betterangels","sheet","actor"],Xt:"systems/betterangels/hbs/actor/actor-sheet.html",width:476,height:786,Gt:[{Wt:".sheet-tabs",Kt:".sheet-body",Vt:"front"}]})}get Xt(){return`systems/betterangels/hbs/actor/actor-${this.m.data.type}-sheet.html`}getData(){const t={...super.getData()};return this.qt(t),this.Jt(t),this.Qt(t),t}qt(t){Object.assign(t,{...t,type:t.m.data.type,data:t.m.data.data,flags:t.m.data.flags})}Qt(e){e.data.Ut=t.Yt.map((t=>this.Zt(t)))}Jt(t){Object.assign(t.data,{te:t.items.filter((t=>"power"===t.type)).slice(t.data.ee?-3:-2),se:t.items.filter((t=>"aspect"===t.type)).slice(-2),ae:t.items.filter((t=>"device"===t.type)).slice(-2)})}get ie(){return $(`#actor-${this.m.id}`)}get re(){return Boolean(this.ie.find(".is-dragging")[0])}oe(t){if(super.oe(t),console.log(this.ne),t.find(".trait-label").he(this.le.bind(this)),t.find(".trait-label").ce(this.ue.bind(this)),!this.de)return;t.find(".trait-cell").contextmenu(this.pe.bind(this)),t.find(".trait-cell").ce(this.ge.bind(this)),t.find(".trait-button").click(this.me.bind(this)),t.find(".trait-button").contextmenu(this.me.bind(this)),t.find('.trait-label[data-type="strategy"][data-sub-type="sinister"]').$e(this.ye.bind(this)),t.find(".hover-target video").be("ended",(({currentTarget:t})=>{t.currentTime=0})),t.find(".feature").click((t=>{this.m.items.get(t.currentTarget.dataset.itemId).sheet.fe(!0)})),s.create(this.ie.find(".trait-label"),{ve:[this],xe(t){this.sheet=t,$(this.target).Te("is-dragging"),this.D=$(this.target).data("trait"),this.type=$(this.target).data("type"),this.De="strategy"===this.type?"tactic":"strategy",[this.we]=this.sheet.ie.find(".trait-label.is-dragging + .trait-label-bg"),[this.Ae,this.Ce]=r.ke(Array.from(this.sheet.ie.find(".trait-draggable:not(.is-dragging)")),(t=>$(t).data("type")!==this.type)),this.Pe=Array.from(this.sheet.ie.find(".hover-target")),this.Se=[...this.Ae,this.we],this.Me=[...this.Se,...this.Pe],console.log("DRAG START",{Oe:this,we:this.we,Ae:this.Ae,Se:this.Se,Pe:this.Pe,Me:this.Me}),this.sheet._e(this),this.sheet.Re(this.target,"dragging",{Ie:.5,Tt:"elastic"}),this.sheet.Re(this.Ae,"bright",{duration:1,Tt:"sine",Dt:10}),this.sheet.Re(this.Ce,"faded",{Ie:1,Tt:"sine",Dt:1}),this.sheet.Re(this.Pe,"visible",{duration:1,Dt:2,Ee:"start"})},je(){const t=this.sheet.Fe(this);t!==this.He&&(this.sheet.Ne(t,this.He),this.He=t);const e=this.sheet.Be(this);e!==this.Le&&(this.sheet.ze(e,this.Le),this.Le=e)},Xe(){this.disable(),this.He&&this.sheet.Ge.Nt(),this.sheet.Ge=null,this.sheet.Re([...this.Se,...this.Ce].filter((t=>t!==this.He)),"base",{duration:.5,Tt:"sine",Dt:5}),this.sheet.Re(this.Pe,"hidden",{duration:.5,Tt:"sine",Dt:2}),window.dragSheet=this.sheet,window.Pe=this.Pe,this.sheet.Re(this.He,"base",{duration:5}),this.sheet.Re(this.target,"hoverOver",{duration:1.5,Tt:"power2"}).then((()=>{this.sheet.Re(this.target,"base",{duration:0}),e.set(this.target,{x:0,y:0}),$(this.target).We("is-dragging"),this.enable()}))}})}fe(...t){delete this.Ke,super.fe(...t)}_e(t){this.Ge=new h(t),console.log(this.Ge)}get Ge(){return this.Ve??!1}set Ge(t){this.Ve=t}Fe(t){const e=e=>s=>t.qe(s,`${e}%`);let s,[a]=r.ke(t.Se,e(50));for(let t=40;t>=0&&!(a.length<=1);t-=10)[a,s]=r.ke(a,e(t));return[...a,...s??[]].shift()}Be(t){const e=e=>s=>t.qe(s,`${e}%`);let s,[a]=r.ke(t.Pe,e(50));for(let t=40;t>=0&&!(a.length<=1);t-=10)[a,s]=r.ke(a,e(t));return[...a,...s??[]].shift()}get ne(){return this.Ke||(this.Ke=new Map,this.ie.find(".trait-draggable").Je(((t,e)=>{this.Ke.set(e,this.Qe(e))})),this.ie.find(".hover-target").Je(((t,e)=>{this.Ke.set(e,this.Ue(e))}))),this.Ke}Ye(t){return this.ne.get(r.ct(t))}Ze(t){return r.ts(t).map((t=>this.ne.get(t)))}Qe(s){$(s).data("trait");const a=$(s).data("type"),[i]=$(s).find(".display-name"),[r]=$(s).find(".roll-desc");return e.timeline({paused:!0,data:{},os:{Tt:"none"}}).ss("faded",0).rs(s,{yt:.25,scale:1},{yt:1}).rs(i,{yt:1,scale:.9,color:t.ls.hs.ns,textShadow:t.ls.us.cs},{scale:1},"<").rs(r,{yt:0,ds:0},{ds:.1},"<").ss("base").to(i,{color:t.ls.hs.ps,scale:1.15}).ss("bright").to(i,{color:t.ls.hs[`${a}Dark`],scale:1.25,textShadow:t.ls.us[`${a}Hover`]}).ss("hoverOver").to(i,{color:t.ls.hs.gs,scale:1.5,textShadow:t.ls.us.He}).ss("dropTarget").to(i,{color:t.ls.hs[`${a}Dark`],scale:1,textShadow:t.ls.us[`${a}Hover`]}).to(r,{yt:1,ds:1},"<").to(s,{scale:2},"<").ss("dragging").es("base")}Ue(s){const a=$(s),i=a.data("action"),[r]=(a.data("type"),a.find(".target-icon")),[o]=a.find(".target-label"),[n]=a.find("video"),[h]=a.find(".target-trigger-anim"),l=e.timeline({paused:!0,data:{},os:{Tt:"none"}}).ss("hidden").rs([s,r,n],{yt:0,scale:1,textShadow:0,outline:0},{yt:.75,scale:.8,Dt:.25},0).rs(h,{yt:0,scale:0,textShadow:0,outline:0},{scale:.1},0).rs(o,{yt:0,scale:1,textShadow:0,outline:0},{yt:1,textShadow:t.ls.us[`${i}HoverTrigger`],delay:.5},0).ss("visible").to([s,r,n],{yt:1,scale:1,duration:.1}).to(o,{$s:[{scale:1,outline:0},{scale:1.25,outline:0},{scale:1,outline:0},{scale:1,outline:`3px solid ${t.ls.hs[`${i}HoverTrigger`]}`}],duration:.1},"<").ss("startCycle");return l.call((()=>{l.reversed()||(n.currentTime=0,n.play())})).to(r,{$s:[{scale:1},{scale:.75},{scale:1},{scale:5},{scale:1}],Tt:"sine.inOut",duration:n.duration},"<").rs(h,{yt:0,scale:0},{yt:.75,scale:1,Tt:"power2.in",duration:n.duration,It:[this],Et(t){l.reversed()||"endCycle"!==l.data.ys||t.bs(s)}},"<").call((()=>{l.reversed()||"endCycle"!==l.data.ys||(n.currentTime=0)})).to(n,{yt:0,duration:.25}).to(h,{$s:[{yt:.75,duration:.25},{yt:1,duration:.25},{yt:0,duration:.5}],Tt:"power4.out"},"<").to(h,{scale:10,Tt:"power4.out",duration:1},"<").to(h,{scale:1,duration:0}).call((()=>{l.reversed()||"endCycle"!==l.data.ys||this.Re(s,"endCycle",{from:"startCycle",Ie:20})})).ss("endCycle").es("hidden"),l}Re(t,s,{from:a,fs:i=0,Ie:r=.5,duration:o,Tt:n,Dt:h=0,Ee:l="random"}={}){const c=this.Ze(t).map((e=>{if(e){const c=a??e.vs();e.labels[c]>=e.labels[s]?e.reversed(!0):e.reversed(!1),e.data.ys=s;const u=a?e.xs(a,s,n?{Tt:n,paused:!0}:{paused:!0}):e.Ts(s,n?{Tt:n,paused:!0}:{paused:!0}),d=u.duration(),p=o??Math.max(Math.min(d,r),i),g={[`${t}`]:s,Ds:{fs:i,Ie:r,duration:o,Tt:n,Dt:h,Ee:l},duration:{ws:d,As:p}};return parseFloat(p)!==parseFloat(d)&&u.Cs(d/p),g.duration.ks=u.duration(),u}return!1})).filter((t=>Boolean(t)));if(0===c.length)return[];if(1===c.length)return c[0].delay(0).play();if(h>0){const t=e.Ft.Ps({Ss:h,from:l});return c.map(((e,s,a)=>e.delay(t(s,a[s],a)).play()))}return c.map((t=>t.delay(0).play()))}le({currentTarget:t}){this.re||this.Re(t,"hoverOver",{from:"bright",duration:.25,Tt:"power2.out"})}ue({currentTarget:t}){this.re||this.Re(t,"base",{duration:.25,Tt:"power2.in"})}Ne(t,e){[t,e]=r.ts(t,e),console.log("SET DROPPABLE",{Ms:e,Os:t,_s:!(!e||$(e).$t("trait-label-bg"))&&$(e).data("trait"),Rs:!(!t||$(t).$t("trait-label-bg"))&&$(t).data("trait")}),e&&!$(e).$t("trait-label-bg")&&(this.Re(e,"bright"),this.Ge.Mt($(e).data("trait"))),t&&!$(t).$t("trait-label-bg")&&(this.Re(t,"dropTarget",{duration:.25}),this.Ge.St($(t).data("trait")))}ze(t,s){[t,s]=r.ts(t,s),s&&this.Re(s,"visible",{Ie:.25}),t&&e.timeline().add(this.Re(t,"startCycle",{Ie:.25})).call((()=>this.Re(t,"endCycle",{Ie:20})))}bs(t){switch($(t).data("action")){case"add":this.Ge.add(t);break;case"toWidth":this.Ge.Ot();break;case"toHeight":this.Ge.jt();break;case"reset":this.Ge.reset()}}async Is(e,s,a,i,o={}){e===a&&(a=!1);const n=[],h=[];for(const[o,h]of[[e,s],[a,i]])if(o){const e=['<span class="character">(</span>',`<span class="trait-value">${h}</span>`,'<span class="character">)</span>'];t.Y.includes(o)?(e.unshift(`<span class="trait-name strategy">${r.Es(o)}</span>`),n.unshift(e.join(""))):t.Z.includes(o)?(e.unshift(`<span class="trait-name tactic">${r.Es(o)}</span>`),n.push(e.join(""))):(e.unshift(`<span class="trait-name">${r.Es(o)}</span>`),n.push(e.join("")))}let l=0,c=0;for(const[t,{C:e,width:s}]of Object.entries(o)){const a=`<span class="advantage-glyph">${{P:"‚öîÔ∏è",S:'<span style="color: #FF0000; font-weight: bold; text-shadow: 0 0 3px black, 0 0 3px black, 0 0 3px black;">!!</span>',M:"üîç"}[t]}</span>`;e&&(l+=e,n.push(`<span class="trait-value">${e}</span>${a}`)),s&&(c+=s,h.push(`<span class="trait-value">+${s}</span>${a}`))}const u=r.js(s)+r.js(i)+r.js(l),d=[n.join('<span class="operator">+</span>'),'<span class="operator">=</span>',`<span class="pool-total">${u}</span>`].join(""),p=game.oneRollEngine.createRawRoll(u),{Fs:g,Hs:m,Ns:$}=game.oneRollEngine.parseRawRoll(p,d),y=g.sort(((t,e)=>t.width>e.width?-10:e.width>t.width?10:e.height-t.height));0===g.length&&(h.length=0),console.log({Fs:g,Hs:m,Bs:$,Ls:h,i:o});const b={content:await renderTemplate("systems/betterangels/hbs/chat/ORE-roll.html",{name:this.m.name,Fs:y,Hs:m,Bs:$,Ls:h.join(", ")}),type:CONST.CHAT_MESSAGE_TYPES.ROLL,zs:p,flags:{Xs:{Gs:!0}}};return ChatMessage.create(b,{})}Zt(e){const[s,a]=t.Yt.includes(e)?[e,t.Ws[e]]:[t.Ws[e],e],{data:i}=this.X,[o,n]=[i[s],i[a]],h=[{name:s,displayName:r.Es(s),type:t.Y.includes(s)?"strategy":"tactic",Ks:"sinister",...o,Vs:o.value<o.max&&n.value>n.min,qs:o.value<o.max&&o.value+n.value<7,Js:o.value>o.min,Qs:o.max-o.value,isPrimary:s===i.Us,Ys:t.Zs[t.Y.includes(s)?"At":"Ct"]},{name:a,displayName:r.Es(a),type:t.Y.includes(a)?"strategy":"tactic",Ks:"virtuous",...n,Vs:n.value<n.max&&o.value>o.min,qs:n.value<n.max&&n.value+o.value<7,Js:n.value>n.min,Qs:n.max-n.value,isPrimary:!1,Ys:t.Zs[t.Y.includes(s)?"At":"Ct"]}];return console.log(`getTraitPairData(${e})`,{Yt:h[0],ta:h[1]}),h}ea(e){e=t.sa[e]??e;const[s,a]=this.Zt(e);r.aa({ia:{ra:s.qs,oa:s.Js},na:{ra:a.qs,oa:a.Js},ha:{la:s.Vs},ca:{ua:a.Vs}},((t,e)=>r.aa(t,((t,s)=>{const a=$(`#actor-${this.m.id} .radial-menu .menu-container .menu-button ${e}`);t?a.Te(s):a.We(s)}))))}pe(t){t.preventDefault();const[s]=$(t.currentTarget).find(".menu-positioner");$(s).find(".radial-menu").$t("active")||(e.set(s,{dt:-50,gt:-50,x:t.offsetX,y:t.offsetY}),$(s).find("video").Je((function(){this.play()})),$(s).find(".radial-menu").Te("active"))}ge(t){t.preventDefault();const[e]=$(t.currentTarget).find(".menu-positioner");$(e).find("video").Je((function(){this.pause()})),$(e).find(".radial-menu").We("active"),setTimeout((()=>this.da()),500)}async me(e){e.preventDefault();const{pa:s,ga:a,target:i}=e.target.dataset,{data:r}=this.X,o=this.Zt(i).find((({name:t})=>t===i)),n={click:s,contextmenu:a}[e.type];switch(console.log({ma:e,pa:s,ga:a,target:i,data:r,action:n,$a:o}),n){case"add":if(o.qs){const t=Math.min(o.max,o.value+1);this.ya({[`data.${i}.value`]:t}),this.ba(i,t)}break;case"drop":o.Js&&(this.fa(i,r[i].value),this.ya({[`data.${i}.value`]:Math.max(r[i].min,r[i].value-1)}));break;case"slide":if(o.Vs){const e=t.Ws[i],s=Math.min(r[i].max,r[i].value+1);this.va(i,s,e,r[e].value),this.ya({[`data.${i}.value`]:s,[`data.${e}.value`]:Math.max(r[e].min,r[e].value-1)})}break;default:return!1}return this.ea(i),!0}xa(t,s,a=!1){const i=this.ie.find(`.dot-line[data-trait="${t}"] > .dot-${s}`),o=i.Ta(".trait-cell");let n=o.find(`.dot-${s}.add-drop`);if(n.length>0)return console.log(`Existing Animation Dot: ${t}-${s}`),n;console.log(`Creating Animation Dot: ${t}-${s}`),n=i.clone().Te("add-drop").Da({background:"cyan"}).ut(o);const h=r.wa(i,o);e.set(r.ct(n),{position:"absolute",dt:-50,gt:-50,height:r.get(i,"height"),width:r.get(i,"width"),x:h.x,y:h.y,zIndex:100});const l=e.timeline({paused:!0,Et(){i.Te("full"),n.remove()},Aa(){i.We("full"),n.remove()}}).from(n,{scale:10,yt:0,Tt:"sine",duration:.75},0);return a&&l.es(l.duration()),n.data("timeline",l),n}ba(t,e){console.log(`Filling ${t}-${e}`);const s=this.xa(t,e).data("timeline");s.reversed(!1),s.resume()}fa(t,e){console.log(`Emptying ${t}-${e}`);const s=this.xa(t,e,!0).data("timeline");s.reversed(!0),s.resume()}va(t,s,a,i){const[o]=$(`#actor-${this.m.id} #${a}-${i} > .dot-slot`),[n]=$(`#actor-${this.m.id} #${t}-${s} > .dot-slot`),[h]=$('<span class="dot-slot full top-layer">&nbsp;</span>').ut(`#actor-${this.m.id} #${a}-${i}`);e.to(h,{...r.Ca({x:0,y:0},$(n).parent()[0],$(o).parent()[0]),duration:.5,Tt:"slow(0.7, 0.7)",ka(){$(o).We("full")},Pa(){$(n).Te("full"),$(h).remove()},Et(){$(n).Te("full"),$(h).remove()}}),e.to(h,{scale:5,duration:.5,Tt:"slow(0.7, 0.7, true)"})}async ye(t){const e=t.currentTarget.dataset.D;await this.m.update({Sa:e})}}export default l;export const HOOKS={Ma:(t,s)=>{const{type:a}=s,{m:i}=t,{items:r}=i,o=Array.from(r.values()).filter((t=>t.type===s.type)).map((t=>t.id)),n={Oa:i.data.data.ee?3:2,_a:2,device:3}[a],h=[];for(;o.length>=n;)h.push(o.shift());console.log({type:a,m:i,items:r,Ra:o,Ia:n,Ea:h}),h.length&&(i.ja("Item",h),e.Fa(.25,(()=>i.sheet.fe())))}};export const EFFECTS=[{name:"fade",effect:(t,s)=>e.to(t,{yt:1,duration:s.duration,Aa(){e.set(this.Ha,{Na:"transform"})}}),os:{duration:.25},Ba:!0},{name:"brighten",effect:(s,a)=>e.to(s,{color:t.ls.hs.ps,scale:1.25,duration:a.duration,Aa(){e.set(this.Ha,{Na:"transform"})}}),os:{duration:.25},Ba:!0},{name:"darken",effect:(t,s)=>e.to(t,{opacity:.25,duration:s.duration,Aa(){e.set(this.Ha,{Na:"transform"})}}),os:{duration:.25},Ba:!0},{name:"iconFadeIn",effect:(t,s)=>e.rs(t,{scale:3,yt:0,x:30,y:-30},{scale:1,yt:1,x:0,y:0,duration:s.duration,Tt:s.Tt,Dt:s.Dt}),os:{duration:.5,Tt:"back(2)",Dt:.25},Ba:!0}];